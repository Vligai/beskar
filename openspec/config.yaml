schema: spec-driven

context: |
  Project: Beskar — Claude-native token optimization library
  Language: TypeScript, wraps the Anthropic SDK (@anthropic-ai/sdk)
  Purpose: Drop-in replacement for anthropic.messages.create() that automatically applies prompt caching, context pruning, tool result compression, and token metrics to reduce costs in agentic pipelines.

  V1 modules: cache/, pruner/, compressor/, metrics/, client.ts, types.ts
  Each module is independently opt-in via BeskarConfig.

  Key Claude API constraints to respect:
  - Cache breakpoints: cache_control { type: "ephemeral" }, max 4 per request, min 1024 tokens (Sonnet/Opus) or 2048 (Haiku)
  - Tool call integrity: tool_use and tool_result must stay paired by tool_use_id — never drop one without the other
  - Metrics come from response.usage: input_tokens, output_tokens, cache_creation_input_tokens, cache_read_input_tokens

  Conventions: conventional commits, no classes where functions suffice, measurable over clever
